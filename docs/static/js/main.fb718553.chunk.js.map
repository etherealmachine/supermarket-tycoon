{"version":3,"sources":["webpack:///./src/TopBar-classes.astroturf.css?6b84","TopBar-classes.astroturf.css","State.ts","Persistence.ts","BlankCustomerCard.tsx","CustomerCard.tsx","TopBar.tsx","StockRoom.tsx","Department.tsx","Store.tsx","App.tsx","index.tsx"],"names":["content","module","i","options","transform","undefined","locals","exports","___CSS_LOADER_API_IMPORT___","push","undoStack","modify","state","propertyKey","descriptor","modifierFn","value","args","Array","from","arguments","this","setState","produce","newState","prev","JSON","stringify","bind","curr","undoable","length","splice","hasOwnProperty","notifyChange","DeptName","bakery","dairy","dryGoods","frozen","Expirations","shuffle","array","j","Math","floor","random","tmp","probabilities","2","3","4","5","6","7","8","9","10","11","12","couponOptions","State","cash","round","phase","departments","price","salePrice","sale","stock","never","every","stockRoom","customers","name","coupons","penalty","cartSize","cart","demand","bonus","costs","currentCustomers","currentCustomerIndex","currentCosts","setup","Object","keys","forEach","key","prepare","nextCustomer","pop","Error","visible","nextCosts","customerIndex","slice","customer","roll","shopping","values","dept","startCleanup","endGame","department","advanceCustomer","expiration","expiry","inDemand","find","includes","opts","filter","d","option","opt","removeOldestItem","coupon","impulseBuy","item","assign","parse","cannotPurchase","canPurchase","hasStock","opt1","opt2","count","reduce","sum","inStockRoom","inStore","canAdvanceCustomer","type","NaN","Context","React","createContext","isObject","isArray","unfreeze","o","oo","v","String","property","useLocalStorageState","initial","fromLocalStorage","window","localStorage","getItem","inflate","target","objs","obj","shift","isFrozen","useState","setItem","BlankCustomerCard","props","index","useContext","className","canStartCustomer","onClick","startCustomer","canStartRestocking","startRestocking","ItemBadge","text","CustomerCard","classNames","fill","map","_","entries","demandCurve","toFixed","purchase","icon","faPlus","canPurchaseWithCoupon","purchaseWithCoupon","canImpulseBuy","canFinishCustomer","finishCustomer","mustFailCustomer","failCustomer","StockButton","disabled","canMoveStock","moveStock","style","height","StockRoom","scope","canBuyStock","buyStock","Department","deptKey","startSale","toString","Store","_props","App","setCount","app","path","width","maxWidth","marginRight","marginLeft","Provider","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.fb718553.chunk.js","sourcesContent":["\nvar content = require(\"!!../node_modules/astroturf/css-loader.js!./TopBar-classes.astroturf.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/astroturf/css-loader.js!./TopBar-classes.astroturf.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/astroturf/css-loader.js!./TopBar-classes.astroturf.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/astroturf/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n  ._3yWrz0X0-IjlWfvmG2JrT- {\\n    text-decoration: underline;\\n  }\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"underline\": \"_3yWrz0X0-IjlWfvmG2JrT-\"\n};\nmodule.exports = exports;\n","import React from 'react';\nimport { produce } from 'immer';\n\nlet undoStack = [] as string[];\n\nfunction modify(options?: { undoable: boolean }) {\n  return function (\n    state: State,\n    propertyKey: string,\n    descriptor: PropertyDescriptor\n  ) {\n    const modifierFn = descriptor.value;\n    descriptor.value = function () {\n      const args = Array.from(arguments);\n      (this as any).setState(produce(this, (newState: State) => {\n        const prev = JSON.stringify(newState);\n        modifierFn.bind(newState)(...args);\n        const curr = JSON.stringify(newState);\n        if (options && options.undoable && (undoStack.length === 0 || undoStack[undoStack.length - 1] !== prev) && curr !== prev) {\n          undoStack.push(prev);\n          if (undoStack.length > 100) undoStack.splice(0, undoStack.length - 100);\n        }\n        if (newState.hasOwnProperty('notifyChange')) {\n          newState.notifyChange();\n        }\n      }));\n    };\n  };\n}\n\nexport interface CartItem {\n  dept: string\n  price: number\n  coupon: boolean\n  sale: boolean\n}\n\nexport interface Customer {\n  name: string\n  coupons: number\n  bonus?: number\n  penalty: number\n  cartSize: number\n  impulseBuy?: CartItem\n  cart: CartItem[]\n  demand: { [key: string]: number[] }\n  visible?: boolean\n  shopping?: boolean\n  roll?: number\n}\n\nconst initialCustomers: () => Customer[] = () => [\n  {\n    name: 'Regina',\n    coupons: 1,\n    penalty: 4,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [2, 3, 4],\n      dairy: [5, 6],\n      produce: [7],\n      bakery: [8, 9],\n      dryGoods: [10, 11, 12],\n    },\n  },\n  {\n    name: 'Ryan',\n    coupons: 1,\n    penalty: 2,\n    cartSize: 2,\n    cart: [],\n    demand: {\n      frozen: [6, 7, 8],\n      dairy: [4, 5],\n      produce: [2, 3],\n      bakery: [11, 12],\n      dryGoods: [9, 10],\n    },\n  },\n  {\n    name: 'Rory',\n    coupons: 0,\n    penalty: 4,\n    cartSize: 1,\n    cart: [],\n    demand: {\n      frozen: [],\n      dairy: [6, 7, 8],\n      produce: [9, 10, 11, 12],\n      bakery: [],\n      dryGoods: [2, 3, 4, 5],\n    },\n  },\n  {\n    name: 'Dave',\n    coupons: 2,\n    bonus: 8,\n    penalty: 12,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [11, 12],\n      dairy: [7],\n      produce: [2, 3, 4],\n      bakery: [5, 6],\n      dryGoods: [8, 9, 10],\n    },\n  },\n  {\n    name: 'Lesley',\n    coupons: 0,\n    penalty: 5,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [12],\n      dairy: [3, 4, 5],\n      produce: [6, 7, 8],\n      bakery: [9, 10, 11],\n      dryGoods: [2],\n    },\n  },\n  {\n    name: 'Mo',\n    coupons: 0,\n    penalty: 3,\n    cartSize: 1,\n    cart: [],\n    demand: {\n      frozen: [],\n      dairy: [2, 3],\n      produce: [4, 5, 6, 7],\n      bakery: [8, 9, 10],\n      dryGoods: [11, 12],\n    },\n  },\n  {\n    name: 'Amanda',\n    coupons: 0,\n    penalty: 5,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [4, 5, 6],\n      dairy: [],\n      produce: [2, 3],\n      bakery: [10, 11, 12],\n      dryGoods: [7, 8, 9],\n    },\n  },\n  {\n    name: 'Scott',\n    coupons: 0,\n    penalty: 6,\n    cartSize: 2,\n    cart: [],\n    demand: {\n      frozen: [],\n      dairy: [7, 8, 9, 10, 11],\n      produce: [3, 4, 5, 6],\n      bakery: [2],\n      dryGoods: [12],\n    },\n  },\n  {\n    name: 'Wendell',\n    coupons: 0,\n    penalty: 5,\n    cartSize: 1,\n    cart: [],\n    demand: {\n      frozen: [2, 3, 4, 5],\n      dairy: [9, 10, 11, 12],\n      produce: [8],\n      bakery: [7],\n      dryGoods: [6],\n    },\n  },\n  {\n    name: 'Diane',\n    coupons: 0,\n    penalty: 7,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [11, 12],\n      dairy: [2, 3],\n      produce: [],\n      bakery: [4, 5, 6, 7, 8, 9, 10],\n      dryGoods: [],\n    },\n  },\n  {\n    name: 'Gary',\n    coupons: 2,\n    penalty: 7,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [11, 2],\n      dairy: [5, 6],\n      produce: [7, 8],\n      bakery: [9, 10],\n      dryGoods: [2, 3, 4],\n    },\n  },\n  {\n    name: 'Margaret',\n    coupons: 0,\n    penalty: 3,\n    cartSize: 2,\n    cart: [],\n    demand: {\n      frozen: [2, 3, 4],\n      dairy: [7, 8],\n      produce: [5, 6],\n      bakery: [9, 10],\n      dryGoods: [11, 12],\n    },\n  },\n  {\n    name: 'Amy',\n    coupons: 0,\n    bonus: 10,\n    penalty: 15,\n    cartSize: 5,\n    cart: [],\n    demand: {\n      frozen: [2, 3, 4],\n      dairy: [12],\n      produce: [7, 8],\n      bakery: [9, 10, 11],\n      dryGoods: [5, 6],\n    },\n  },\n  {\n    name: 'Tiffany',\n    coupons: 1,\n    penalty: 3,\n    cartSize: 2,\n    cart: [],\n    demand: {\n      frozen: [9, 10, 11, 12],\n      dairy: [8],\n      produce: [7],\n      bakery: [5, 6],\n      dryGoods: [2, 3, 4],\n    },\n  },\n  {\n    name: 'Chris',\n    coupons: 1,\n    penalty: 9,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [11, 12],\n      dairy: [2],\n      produce: [3, 4, 5, 6],\n      bakery: [10],\n      dryGoods: [7, 8, 9],\n    },\n  },\n  {\n    name: 'George',\n    coupons: 1,\n    penalty: 8,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [8, 9, 10, 11, 12],\n      dairy: [],\n      produce: [],\n      bakery: [2, 3, 4, 5, 6, 7],\n      dryGoods: [],\n    },\n  },\n  {\n    name: 'Mikolaj',\n    coupons: 1,\n    penalty: 4,\n    cartSize: 2,\n    cart: [],\n    demand: {\n      frozen: [10, 11, 12],\n      dairy: [2, 3, 4],\n      produce: [],\n      bakery: [7],\n      dryGoods: [5, 6],\n    },\n  },\n  {\n    name: 'Rose',\n    coupons: 1,\n    penalty: 6,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [6, 7],\n      dairy: [5],\n      produce: [2, 3, 4],\n      bakery: [11, 12],\n      dryGoods: [8, 9, 10],\n    },\n  },\n  {\n    name: 'Stu',\n    coupons: 0,\n    penalty: 8,\n    cartSize: 2,\n    cart: [],\n    demand: {\n      frozen: [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],\n      dairy: [],\n      produce: [],\n      bakery: [],\n      dryGoods: [],\n    },\n  },\n  {\n    name: 'Melanie',\n    coupons: 0,\n    penalty: 5,\n    cartSize: 1,\n    cart: [],\n    demand: {\n      frozen: [2, 3],\n      dairy: [8, 9, 10],\n      produce: [11, 12],\n      bakery: [4],\n      dryGoods: [5, 6, 7],\n    },\n  },\n  {\n    name: 'Phil',\n    coupons: 2,\n    penalty: 10,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [],\n      dairy: [7, 8, 9],\n      produce: [4, 5, 6],\n      bakery: [10, 11, 12],\n      dryGoods: [2, 3],\n    },\n  },\n  {\n    name: 'ZoÃ«',\n    coupons: 1,\n    bonus: 9,\n    penalty: 13,\n    cartSize: 5,\n    cart: [],\n    demand: {\n      frozen: [2, 3, 4],\n      dairy: [9, 10],\n      produce: [11, 12],\n      bakery: [5, 6, 7],\n      dryGoods: [8],\n    },\n  },\n  {\n    name: 'Chad',\n    coupons: 1,\n    penalty: 6,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [9],\n      dairy: [2, 3],\n      produce: [7, 8],\n      bakery: [4, 5, 6],\n      dryGoods: [10, 11, 12],\n    },\n  },\n  {\n    name: 'Albert',\n    coupons: 1,\n    penalty: 5,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [11, 12],\n      dairy: [8, 9, 10],\n      produce: [5, 6],\n      bakery: [7],\n      dryGoods: [2, 3, 4],\n    },\n  },\n  {\n    name: 'Jordan',\n    coupons: 0,\n    penalty: 8,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [9],\n      dairy: [2, 3, 4],\n      produce: [5],\n      bakery: [6, 7, 8],\n      dryGoods: [10, 11, 12],\n    },\n  },\n  {\n    name: 'Martha',\n    coupons: 1,\n    penalty: 6,\n    cartSize: 2,\n    cart: [],\n    demand: {\n      frozen: [10, 11, 12],\n      dairy: [8, 9],\n      produce: [6, 7],\n      bakery: [2, 3, 4, 5],\n      dryGoods: [],\n    },\n  },\n  {\n    name: 'Jackie',\n    coupons: 2,\n    penalty: 9,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [11, 12],\n      dairy: [7],\n      produce: [4, 5, 6],\n      bakery: [2, 3],\n      dryGoods: [8, 9, 10],\n    },\n  },\n  {\n    name: 'Donna',\n    coupons: 0,\n    penalty: 8,\n    cartSize: 1,\n    cart: [],\n    demand: {\n      frozen: [10, 11, 12],\n      dairy: [8, 9],\n      produce: [5],\n      bakery: [6, 7],\n      dryGoods: [2, 3, 4],\n    },\n  },\n  {\n    name: 'Clara',\n    coupons: 1,\n    penalty: 7,\n    cartSize: 3,\n    cart: [],\n    demand: {\n      frozen: [8],\n      dairy: [5, 6],\n      produce: [9, 10, 11, 12],\n      bakery: [7],\n      dryGoods: [2, 3, 4],\n    },\n  },\n  {\n    name: 'Jacob',\n    coupons: 1,\n    penalty: 8,\n    cartSize: 4,\n    cart: [],\n    demand: {\n      frozen: [6, 7],\n      dairy: [10, 11, 12],\n      produce: [2, 3, 4],\n      bakery: [5],\n      dryGoods: [8, 9],\n    },\n  },\n];\n\nconst initialCosts = () => [\n  {\n    bakery: 3,\n    dairy: 1,\n    dryGoods: 3,\n    frozen: 3,\n    produce: 2,\n  },\n  {\n    bakery: 3,\n    dairy: 2,\n    dryGoods: 5,\n    frozen: 3,\n    produce: 1,\n  },\n  {\n    bakery: 1,\n    dairy: 2,\n    dryGoods: 5,\n    frozen: 3,\n    produce: 3,\n  },\n  {\n    bakery: 2,\n    dairy: 3,\n    dryGoods: 3,\n    frozen: 4,\n    produce: 1,\n  },\n  {\n    bakery: 2,\n    dairy: 3,\n    dryGoods: 4,\n    frozen: 5,\n    produce: 1,\n  },\n  {\n    produce: 1,\n    bakery: 2,\n    dairy: 2,\n    dryGoods: 6,\n    frozen: 4,\n  },\n];\n\nexport type Stock = { [key: string]: number }\n\nexport interface Department {\n  price: number\n  salePrice: number\n  sale: boolean\n  stock: Stock\n}\n\nconst initialDepartments: () => { [key: string]: Department } = () => ({\n  bakery: {\n    price: 4,\n    salePrice: 3,\n    sale: false,\n    stock: {\n      2: 3,\n      3: 0,\n      4: 0,\n      5: 0,\n      6: 0,\n      never: 0,\n    },\n  },\n  dairy: {\n    price: 4,\n    salePrice: 2,\n    sale: false,\n    stock: {\n      3: 3,\n      4: 0,\n      5: 0,\n      6: 0,\n      never: 0,\n    },\n  },\n  dryGoods: {\n    price: 10,\n    salePrice: 7,\n    sale: false,\n    stock: {\n      4: 3,\n      5: 0,\n      6: 0,\n      never: 0,\n    },\n  },\n  frozen: {\n    price: 7,\n    salePrice: 5,\n    sale: false,\n    stock: {\n      never: 3,\n    },\n  },\n  produce: {\n    price: 3,\n    salePrice: 2,\n    sale: false,\n    stock: {\n      every: 3,\n    },\n  },\n})\n\nexport const DeptName: { [key: string]: string } = {\n  bakery: 'Bakery',\n  dairy: 'Dairy',\n  dryGoods: 'Dry Goods',\n  frozen: 'Frozen Foods',\n  produce: 'Produce',\n}\n\nexport const Expirations = ['every', '2', '3', '4', '5', '6', 'never'];\n\nfunction shuffle<T>(array: Array<T>) {\n  let i = array.length;\n  while (0 !== i) {\n    const j = Math.floor(Math.random() * i);\n    i -= 1;\n    const tmp = array[i];\n    array[i] = array[j];\n    array[j] = tmp;\n  }\n}\n\nconst probabilities: { [key: string]: number } = {\n  2: 2.78,\n  3: 5.56,\n  4: 8.33,\n  5: 11.11,\n  6: 13.89,\n  7: 16.67,\n  8: 13.89,\n  9: 11.11,\n  10: 8.33,\n  11: 5.56,\n  12: 2.78,\n}\n\nexport function probability(demandCurve: number[]) {\n  return demandCurve.reduce((sum, roll) => sum + probabilities[roll], 0);\n}\n\nconst couponOptions: { [key: string]: number[] } = {\n  2: [6, 7],\n  3: [4, 10],\n  4: [5, 9],\n  5: [2, 10],\n  6: [4, 12],\n  7: [3, 8],\n  8: [7, 12],\n  9: [5, 11],\n  10: [6, 11],\n  11: [2, 9],\n  12: [3, 9],\n}\n\nexport type DeptKey = keyof ReturnType<typeof initialDepartments>;\n\nexport class State {\n  setState = (state: any) => { }\n  notifyChange = () => { }\n\n  cash: number = 0\n  round: number = 0\n  phase?: 'purchasing' | 'stocking' | 'shopping1' | 'restocking' | 'shopping2' | 'cleanup' = 'purchasing'\n  departments = initialDepartments()\n  stockRoom: { [key: string]: Stock } = {}\n  customers = initialCustomers()\n  costs = initialCosts()\n  currentCustomers: Customer[] = []\n  currentCustomerIndex?: number\n  currentCosts: Stock = {\n    bakery: 0,\n    dairy: 0,\n    dryGoods: 0,\n    frozen: 0,\n    produce: 0,\n  }\n\n  constructor() {\n    if (this.cash === 0 && this.round === 0) {\n      this.setup();\n    }\n  }\n\n  @modify()\n  setup() {\n    this.cash = 15;\n    this.round = 0;\n    this.phase = 'purchasing';\n    this.departments = initialDepartments();\n    this.stockRoom = {};\n    Object.keys(DeptName).forEach(key => {\n      this.stockRoom[key] = {\n        every: 0,\n        2: 0,\n        3: 0,\n        4: 0,\n        5: 0,\n        6: 0,\n        never: 0,\n      };\n    });\n    this.customers = initialCustomers();\n    this.costs = initialCosts();\n    shuffle(this.customers);\n    shuffle(this.costs);\n    this.currentCustomers = [];\n    this.currentCosts = {\n      bakery: 0,\n      dairy: 0,\n      dryGoods: 0,\n      frozen: 0,\n      produce: 0,\n    };\n    this.currentCustomerIndex = undefined;\n    this.prepare();\n  }\n\n  @modify()\n  prepare() {\n    this.round++;\n    for (let i = 0; i < 5; i++) {\n      const nextCustomer = this.customers.pop();\n      if (!nextCustomer) throw new Error('ran out of customers');\n      if (i < 2) nextCustomer.visible = true;\n      this.currentCustomers.push(nextCustomer);\n    }\n    const nextCosts = this.costs.pop();\n    if (!nextCosts) throw new Error('ran out of costs');\n    this.currentCosts = nextCosts;\n    this.currentCustomerIndex = undefined;\n  }\n\n  @modify({ undoable: true })\n  startRestocking(customerIndex: number) {\n    this.phase = 'restocking';\n    if (this.currentCustomerIndex === undefined) {\n      this.currentCustomers.slice(customerIndex, 1);\n    } else if (this.currentCustomerIndex === customerIndex) {\n      const customer = this.currentCustomers[this.currentCustomerIndex];\n      this.cash -= customer.penalty;\n      customer.roll = undefined;\n      this.currentCustomers[this.currentCustomerIndex].shopping = false;\n      this.currentCustomers.splice(this.currentCustomerIndex, 1);\n      this.currentCustomerIndex = undefined;\n    }\n  }\n\n  @modify()\n  startCleanup() {\n    this.currentCustomers = [];\n    this.currentCustomerIndex = undefined;\n    Object.values(this.departments).forEach(dept => {\n      if (this.round in dept.stock) {\n        this.cash -= dept.stock[this.round];\n        dept.stock[this.round] = 0;\n      }\n      if ('every' in dept.stock) {\n        this.cash -= dept.stock['every'];\n        dept.stock['every'] = 0;\n      }\n    });\n    Object.values(this.stockRoom).forEach(stock => {\n      if (this.round in stock) {\n        this.cash -= stock[this.round];\n        stock[this.round] = 0;\n      }\n      if ('every' in stock) {\n        this.cash -= stock['every'];\n        stock['every'] = 0;\n      }\n    });\n  }\n\n  @modify()\n  endGame() {\n  }\n\n  @modify({ undoable: true })\n  nextPhase() {\n    if (this.phase === undefined) {\n      this.phase = 'purchasing';\n      this.prepare();\n      return;\n    } else if (this.phase === 'purchasing') {\n      this.phase = 'stocking';\n      return;\n    } else if (this.phase === 'stocking') {\n      this.phase = 'shopping1';\n      return;\n    } else if (this.phase === 'shopping1' || this.phase === 'shopping2') {\n      this.phase = 'cleanup';\n      this.startCleanup();\n      return;\n    } else if (this.phase === 'restocking') {\n      this.phase = 'shopping2';\n      return;\n    } else if (this.phase === 'cleanup') {\n      if (this.round === 6) {\n        this.phase = undefined;\n        this.endGame();\n        return;\n      }\n      this.phase = 'purchasing';\n      this.prepare();\n      return;\n    }\n  }\n\n  @modify({ undoable: true })\n  startSale(department: DeptKey) {\n    this.departments[department].sale = true;\n  }\n\n  @modify({ undoable: true })\n  startCustomer(i: number) {\n    this.currentCustomers[i].visible = true;\n    this.currentCustomers[i].shopping = true;\n    this.currentCustomerIndex = i;\n    this.advanceCustomer();\n  }\n\n  @modify({ undoable: true })\n  advanceCustomer() {\n    if (this.currentCustomerIndex === undefined) throw new Error('no customer');\n    this.currentCustomers[this.currentCustomerIndex].roll = (Math.floor(Math.random() * 6) + 1) + (Math.floor(Math.random() * 6) + 1);\n  }\n\n  @modify({ undoable: true })\n  finishCustomer() {\n    if (this.currentCustomerIndex === undefined) throw new Error('no customer');\n    const customer = this.currentCustomers[this.currentCustomerIndex];\n    if (customer.bonus) this.cash -= customer.bonus;\n    customer.shopping = false;\n    this.currentCustomers.splice(this.currentCustomerIndex, 1);\n    this.currentCustomerIndex = undefined;\n  }\n\n  @modify({ undoable: true })\n  buyStock(dept: string) {\n    this.cash -= this.currentCosts[dept];\n    this.stockRoom[dept][this.expiration(dept)]++;\n  }\n\n  @modify({ undoable: true })\n  moveStock(dept: string, expiry: string | number) {\n    this.stockRoom[dept][expiry]--;\n    this.departments[dept].stock[expiry]++;\n  }\n\n  removeOldestItem(dept: string) {\n    for (let i = 0; i < Expirations.length; i++) {\n      const expiry = Expirations[i];\n      const inStock = this.departments[dept].stock[expiry];\n      if (inStock) {\n        this.departments[dept].stock[expiry]--;\n        return true;\n      }\n    }\n    return false;\n  }\n\n  @modify({ undoable: true })\n  purchase() {\n    if (this.currentCustomerIndex === undefined) throw new Error('no customer');\n    const customer = this.currentCustomers[this.currentCustomerIndex];\n    const roll = customer.roll;\n    if (roll === undefined) throw new Error('cannot purchase without roll');\n    const inDemand = Object.keys(customer.demand).find(key => customer.demand[key].includes(roll));\n    if (inDemand === undefined) throw new Error(`${roll} not found for ${customer.name}`);\n    if (this.departments[inDemand].sale) {\n      const options = couponOptions[roll];\n      const opts = Object.keys(customer.demand).filter(d => options.find(option => customer.demand[d].includes(option)));\n      opts.forEach(opt => this.removeOldestItem(opt));\n      opts.forEach(opt => customer.cart.push({\n        dept: opt,\n        price: this.price(opt),\n        coupon: false,\n        sale: this.departments[opt].sale,\n      }));\n      opts.forEach(opt => this.cash += this.price(opt));\n    }\n    this.removeOldestItem(inDemand);\n    customer.cart.push({\n      dept: inDemand,\n      price: this.price(inDemand),\n      coupon: false,\n      sale: this.departments[inDemand].sale,\n    });\n    this.cash += this.price(inDemand);\n    customer.roll = undefined;\n  }\n\n  @modify({ undoable: true })\n  purchaseWithCoupon() {\n    if (this.currentCustomerIndex === undefined) throw new Error('no customer');\n    const customer = this.currentCustomers[this.currentCustomerIndex];\n    if (customer.roll === undefined) throw new Error('cannot purchase without roll');\n    const options = couponOptions[customer.roll];\n    const opts = Object.keys(customer.demand).filter(d => options.find(option => customer.demand[d].includes(option)));\n    if (opts[1] === undefined) opts[1] = opts[0];\n    opts.forEach(opt => this.removeOldestItem(opt));\n    opts.forEach(opt => customer.cart.push({\n      dept: opt,\n      price: this.price(opt) - 1,\n      coupon: true,\n      sale: false,\n    }));\n    opts.forEach(opt => { this.cash += this.price(opt) - 1 });\n    customer.coupons--;\n    customer.roll = undefined;\n  }\n\n  @modify({ undoable: true })\n  impulseBuy(dept: string) {\n    if (this.currentCustomerIndex === undefined) throw new Error('no customer');\n    const customer = this.currentCustomers[this.currentCustomerIndex];\n    this.removeOldestItem(dept);\n    this.cash += this.price(dept);\n    customer.impulseBuy = {\n      dept: dept,\n      price: this.price(dept),\n      coupon: false,\n      sale: true,\n    };\n  }\n\n  @modify({ undoable: true })\n  failCustomer() {\n    if (this.currentCustomerIndex === undefined) throw new Error('no customer');\n    const customer = this.currentCustomers[this.currentCustomerIndex];\n    customer.cart.forEach(item => {\n      this.cash -= item.price;\n    });\n    this.cash -= customer.penalty;\n    customer.cartSize = 0;\n    customer.roll = undefined;\n    this.currentCustomers[this.currentCustomerIndex].shopping = false;\n    this.currentCustomers.splice(this.currentCustomerIndex, 1);\n    this.currentCustomerIndex = undefined;\n  }\n\n  @modify()\n  undo() {\n    if (undoStack.length === 0) return;\n    const prev = undoStack.pop();\n    if (!prev) return;\n    Object.assign(this, JSON.parse(prev));\n  }\n\n  canStartCustomer(customer: Customer) {\n    return ['shopping1', 'shopping2'].includes(this.phase || '') && !customer.shopping && this.currentCustomerIndex === undefined;\n  }\n\n  canAdvanceCustomer(customer: Customer) {\n    return customer.shopping && !customer.roll && customer.cart.length < customer.cartSize;\n  }\n\n  canFinishCustomer(customer: Customer) {\n    return customer.shopping && !customer.roll && customer.cart.length >= customer.cartSize;\n  }\n\n  mustFailCustomer(customer: Customer) {\n    return customer.shopping && customer.roll && this.cannotPurchase(customer);\n  }\n\n  cannotPurchase(customer: Customer) {\n    return Object.keys(DeptName).find(dept => this.canPurchase(customer, dept)) === undefined;\n  }\n\n  canPurchase(customer: Customer, dept: string) {\n    if (!customer.roll) return false;\n    if (!customer.demand[dept].includes(customer.roll)) return false;\n    if (!this.hasStock(dept)) return false;\n    if (customer.cart.length >= customer.cartSize) return false;\n    if (this.departments[dept].sale) {\n      const options = couponOptions[customer.roll];\n      const [opt1, opt2] = Object.keys(customer.demand).filter(d => options.find(option => customer.demand[d].includes(option)));\n      return this.hasStock(opt1) && this.hasStock(opt2);\n    }\n    return true;\n  }\n\n  canPurchaseWithCoupon(customer: Customer, dept: string) {\n    if (customer.roll === undefined) return false;\n    if (customer.coupons === 0) return false;\n    if (customer.cart.length + 2 > customer.cartSize) return false;\n    const options = couponOptions[customer.roll];\n    const [opt1, opt2] = Object.keys(customer.demand).filter(d => options.find(option => customer.demand[d].includes(option)));\n    if (opt2 === undefined) return opt1 === dept && this.hasStock(opt1, 2);\n    return (opt1 === dept || opt2 === dept) && this.hasStock(opt1) && this.hasStock(opt2);\n  }\n\n  canImpulseBuy(customer: Customer, dept: string) {\n    if (!customer.shopping) return false;\n    if (!this.departments[dept].sale) return false;\n    if (customer.cart.length >= customer.cartSize) return false;\n    if (!this.hasStock(dept)) return false;\n    if (customer.cart.length > 0) return false;\n    if (customer.roll !== undefined) return false;\n    return customer.impulseBuy === undefined;\n  }\n\n  hasStock(dept: string, count: number = 1) {\n    return Object.values(this.departments[dept].stock).reduce((sum, stock) => sum + stock, 0) >= count;\n  }\n\n  price(dept: string): number {\n    return this.departments[dept].sale ? this.departments[dept].salePrice : this.departments[dept].price;\n  }\n\n  inStore(): number {\n    return Object.values(this.departments).reduce(\n      (sum, dept) => sum + Object.values(dept.stock).reduce(\n        (sum, stock) => sum + stock, 0), 0);\n  }\n\n  inStockRoom(): number {\n    return Object.values(this.stockRoom).reduce(\n      (sum, dept) => sum + Object.values(dept).reduce(\n        (sum, stock) => sum + stock, 0), 0);\n  }\n\n  canBuyStock(dept: string): boolean {\n    return this.cash >= this.currentCosts[dept] && this.inStockRoom() < 20;\n  }\n\n  canMoveStock(dept: string, expiry: string): boolean {\n    return this.inStore() < 15;\n  }\n\n  canStartRestocking() {\n    return this.phase === 'shopping1' && (this.currentCustomerIndex === undefined || this.canAdvanceCustomer(this.currentCustomers[this.currentCustomerIndex]));\n  }\n\n  canAdvancePhase() {\n    return !(['shopping1', 'shopping2'].includes(this.phase || '') && this.currentCustomers.length > 0);\n  }\n\n  canUndo() {\n    return undoStack.length > 0;\n  }\n\n  expiration(type: string): string | number {\n    switch (type) {\n      case 'produce':\n        return 'every';\n      case 'bakery':\n        return this.round + 2;\n      case 'dairy':\n        return this.round + 3;\n      case 'dryGoods':\n        return this.round + 4;\n      case 'frozen':\n        return 'never';\n    }\n    return NaN;\n  }\n}\n\nexport const Context = React.createContext(new State());","import { Dispatch, SetStateAction, useState } from \"react\";\n\nfunction isObject(i: any) {\n  return (i && typeof i === 'object' && !Array.isArray(i));\n}\n\nfunction inflate(target: any, ...objs: any[]): any {\n  if (!objs.length) return target;\n  const obj = objs.shift();\n  if (isObject(target) && isObject(obj)) {\n    for (const key in obj) {\n      if (isObject(obj[key])) {\n        if (!target[key]) Object.assign(target, { [key]: {} });\n        inflate(target[key], obj[key]);\n      } else {\n        if (Object.isFrozen(target)) {\n          target = unfreeze(target);\n        }\n        Object.assign(target, { [key]: obj[key] });\n      }\n    }\n  }\n  return inflate(target, ...objs);\n}\n\nfunction unfreeze(o: any) {\n  let oo: any = undefined;\n  if (o instanceof Array) {\n    oo = []; const clone = (v: any) => { oo.push(v) };\n    o.forEach(clone);\n  } else if (o instanceof String) {\n    oo = o;\n  } else if (typeof o == 'object') {\n    oo = {};\n    for (var property in o) { oo[property] = o[property]; }\n  }\n  return oo;\n}\n\nexport function useLocalStorageState<T>(key: string, initial: T): [T, Dispatch<SetStateAction<T>>] {\n  const fromLocalStorage = window.localStorage.getItem(key);\n  if (fromLocalStorage !== null) inflate(initial, JSON.parse(fromLocalStorage));\n  const [state, setState] = useState<T>(initial);\n  return [state, (newState: any) => {\n    window.localStorage.setItem(key, JSON.stringify(newState));\n    setState(newState);\n  }];\n}","import React, { useContext } from 'react';\nimport { Context } from './State';\n\nconst BlankCustomerCard = (props: { index: number }) => {\n  const { index } = props;\n  const state = useContext(Context);\n  return <div className={\"card flex-grow-1 mx-4\"}>\n    <div className=\"card-body d-flex flex-column\">\n      <h5 className=\"card-title\">Customer {index + 1}</h5>\n      <div className=\"d-flex align-items-center justify-content-around\">\n        {state.canStartCustomer(state.currentCustomers[index]) &&\n          <button className=\"btn btn-primary btn-sm\" onClick={() => state.startCustomer(index)}>\n            Start\n          </button>}\n        {state.canStartRestocking() &&\n          <button className=\"btn btn-primary btn-sm\" onClick={() => state.startRestocking(index)}>\n            Restock\n          </button>}\n      </div>\n    </div>\n  </div>;\n}\n\nexport default BlankCustomerCard;","import { faPlus } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport classNames from 'classnames';\nimport React, { useContext } from 'react';\nimport { CartItem, Context, Customer, DeptName, probability } from './State';\n\nconst ItemBadge = (props: { item: CartItem }) => {\n  const { item } = props;\n  const text = `${DeptName[item.dept]} $${item.price}`;\n  if (item.coupon) {\n    return <span className=\"badge badge-warning mx-1\">{text}</span>;\n  }\n  if (item.sale) {\n    return <span className=\"badge badge-success mx-1\">{text}</span>;\n  }\n  return <span className=\"badge badge-primary mx-1\">{text}</span>;\n}\n\nconst CustomerCard = (props: { customer: Customer, index: number }) => {\n  const { customer, index } = props;\n  const state = useContext(Context);\n  return <div className={classNames(\"card mx-4\", { \"shadow bg-white rounded\": customer.shopping })}>\n    <div className=\"card-body\">\n      <div className=\"d-flex justify-content-between\">\n        <h5 className=\"card-title\">{customer.name}</h5>\n        {(Array(customer.coupons).fill(0).map((_, i) => <div key={i}>\n          <span className=\"badge badge-warning mx-2\">Coupon</span>\n        </div>))}\n        {customer.bonus && <span className=\"text-success\">${customer.bonus}</span>}\n        <span className=\"text-danger\">$-{customer.penalty}</span>\n      </div>\n      <div className=\"d-flex align-items-center justify-content-between\">\n        <div className=\"d-flex\">\n          {customer.impulseBuy && <ItemBadge item={customer.impulseBuy} />}\n          {customer.cart.map(item => <ItemBadge item={item} />)}\n        </div>\n        <div>/&nbsp;{customer.cartSize}</div>\n      </div>\n      <div className=\"card-text\">\n        <table className=\"table table-sm\">\n          <tbody>\n            {Object.entries(customer.demand).filter(([type, demand]) => demand.length > 0).map(([type, demand]) => <tr key={type}>\n              <td>{DeptName[type]}</td><td>{probability(demand).toFixed(0)}%</td>\n              <td>\n                {state.canPurchase(customer, type) && <button\n                  onClick={() => state.purchase()}\n                  className={classNames(\n                    \"btn btn-sm\",\n                    {\n                      \"btn-primary\": !state.departments[type].sale,\n                      \"btn-success\": state.departments[type].sale\n                    })}>\n                  <FontAwesomeIcon icon={faPlus} />\n                </button>}\n              </td>\n              <td>\n                {state.canPurchaseWithCoupon(customer, type) && <button\n                  onClick={() => state.purchaseWithCoupon()}\n                  className=\"btn btn-sm btn-warning\">\n                  <FontAwesomeIcon icon={faPlus} />\n                </button>}\n              </td>\n              <td>\n                {state.canImpulseBuy(customer, type) && <button\n                  onClick={() => state.impulseBuy(type)}\n                  className=\"btn btn-sm btn-success\">\n                  <FontAwesomeIcon icon={faPlus} />\n                </button>}\n              </td>\n            </tr>)}\n          </tbody>\n        </table>\n      </div>\n      <div className=\"d-flex justify-content-between\">\n        {state.canStartCustomer(customer) &&\n          <button className=\"btn btn-primary btn-sm\" onClick={() => state.startCustomer(index)}>\n            Start\n        </button>}\n        {state.canAdvanceCustomer(customer) &&\n          <button className=\"btn btn-primary btn-sm\" onClick={() => state.advanceCustomer()}>\n            Next\n        </button>}\n        {state.canFinishCustomer(customer) &&\n          <button className=\"btn btn-primary btn-sm\" onClick={() => state.finishCustomer()}>\n            Finish\n        </button>}\n        {state.mustFailCustomer(customer) &&\n          <button className=\"btn btn-danger btn-sm\" onClick={() => state.failCustomer()}>\n            Fail\n        </button>}\n        {state.canStartRestocking() &&\n          <button className=\"btn btn-primary btn-sm\" onClick={() => state.startRestocking(index)}>\n            Restock\n        </button>}\n      </div>\n    </div>\n  </div>;\n}\n\nexport default CustomerCard;","import { faArrowRight } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport classNames from 'classnames';\nimport React, { useContext } from 'react';\nimport { css } from 'astroturf';\n\nimport { Context, } from './State';\n\nconst classes = css`\n  .underline {\n    text-decoration: underline;\n  }\n`;\n\nconst TopBar = (_props: {}) => {\n  const state = useContext(Context);\n  const phases = {\n    'purchasing': 'Purchasing',\n    'stocking': 'Stocking',\n    'shopping1': 'Shopping',\n    'restocking': 'Restocking',\n    'shopping2': 'Shopping',\n    'cleanup': 'Cleanup',\n  };\n  return <div className=\"d-flex form-inline bg-secondary text-white px-4\">\n    <div className=\"m-2\">Round: {state.round}</div>\n    <div className=\"m-2\">Cash: ${state.cash}</div>\n    <div className=\"d-flex align-items-center\">\n      {Object.entries(phases).map(([phase, name], i, a) => <span key={i}>\n        <span className={classNames(\"m-2\", { [classes.underline]: state.phase === phase })}>{name}</span>\n        {i !== a.length - 1 && <FontAwesomeIcon icon={faArrowRight} />}\n      </span>\n      )}\n      <button\n        disabled={!state.canAdvancePhase()}\n        className=\"m-2 btn btn-primary btn-sm\"\n        onClick={() => state.nextPhase()}>Next Phase</button>\n    </div>\n    <div className=\"ml-auto\">\n      <button disabled={!state.canUndo()} className=\"m-2 btn btn-light btn-sm\" onClick={() => state.undo()}>Undo</button>\n      <button className=\"m-2 btn btn-warning btn-sm\" onClick={() => state.setup()}>New Game</button>\n    </div>\n  </div >;\n}\n\nexport default TopBar;","import { faPlus } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React, { useContext } from 'react';\n\nimport { Context, DeptName, Expirations } from './State';\n\nconst StockButton = (props: { dept: string, expiry: string }) => {\n  const { dept, expiry } = props;\n  const state = useContext(Context);\n  const stock = (state.stockRoom[dept] && state.stockRoom[dept][expiry]) || 0;\n  if (stock === 0 || !['stocking', 'restocking'].includes((state.phase || ''))) {\n    return <span className=\"d-flex align-items-center justify-content-center\" style={{ height: '31px' }}>\n      {stock}\n    </span>;\n  }\n  return <button\n    disabled={!state.canMoveStock(dept, expiry)}\n    className=\"btn btn-sm btn-primary\"\n    onClick={() => state.moveStock(dept, expiry)}>\n    {stock}\n  </button>;\n}\n\nconst StockRoom = () => {\n  const state = useContext(Context);\n  return <div className=\"mx-4 mt-1\">\n    <div className=\"d-flex justify-content-between\">\n      <h5>Stock Room</h5>\n      <div>Space in stock room: {20 - state.inStockRoom()} / 20</div>\n    </div>\n    <div className=\"card\">\n      <div className=\"card-body\">\n        <table className=\"table table-sm\">\n          <thead><tr>\n            <th scope=\"col\">Expiry</th>\n            {Object.entries(DeptName).map(([key, value]) => <th key={key}>{value}</th>)}\n          </tr></thead>\n          <tbody>\n            <tr>\n              <td></td>\n              {Object.keys(DeptName).map(dept => <td key={dept}>${state.currentCosts[dept]}</td>)}\n            </tr>\n            <tr>\n              <td></td>\n              {Object.keys(DeptName).map(dept => <td key={dept} style={{ height: '40px' }}>\n                {state.phase === 'purchasing' && <button\n                  disabled={!state.canBuyStock(dept)}\n                  className=\"btn btn-success btn-sm\"\n                  onClick={() => state.buyStock(dept)}>\n                  <FontAwesomeIcon icon={faPlus} />\n                </button>}\n              </td>)}\n            </tr>\n            {Expirations.map(expiry => <tr key={expiry}>\n              <td>{expiry}</td>\n              {Object.keys(DeptName).map((key) => <td key={key}><StockButton dept={key} expiry={expiry} /></td>)}\n            </tr>)}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>;\n}\n\nexport default StockRoom;","import classNames from 'classnames';\nimport React, { useContext } from 'react';\nimport { Context, Department as DepartmentType, DeptName } from './State';\n\nconst Department = (props: { deptKey: string, dept: DepartmentType }) => {\n  const { deptKey, dept } = props;\n  const state = useContext(Context);\n  return <div className=\"card flex-grow-1 mx-3 mb-4\">\n    <div className=\"card-body d-flex flex-column\">\n      <div className=\"d-flex justify-content-center\">\n        <h5>{DeptName[deptKey]}</h5>\n        <div className=\"ml-auto\">Price: ${dept.sale ? dept.salePrice : dept.price}</div>\n        <div className=\"mx-2\">\n          {dept.sale ?\n            <span className=\"badge badge-success\">Sale</span> :\n            (state.phase === 'stocking' && <button\n              onClick={() => state.startSale(deptKey)}\n              className=\"btn btn-success btn-sm\">\n              Sale\n             </button>)\n          }\n        </div>\n      </div>\n      <table className=\"table table-sm\">\n        <thead><tr><th scope=\"col\">Expiry</th><th>Stock</th></tr></thead>\n        <tbody>\n          {Object.entries(dept.stock).map(([expiry, count]) => <tr key={expiry}\n            className={classNames({\n              'bg-danger': (expiry === 'every' || expiry === state.round.toString()),\n              'bg-warning': (expiry === (state.round + 1).toString()),\n            })}>\n            <td>{expiry}</td>\n            <td>\n              {count}\n            </td>\n          </tr>\n          )}\n        </tbody>\n      </table>\n    </div>\n  </div>;\n}\n\nexport default Department;","import React, { useContext } from 'react';\nimport { Context, } from './State';\n\nimport Department from './Department';\n\nconst Store = (_props: {}) => {\n  const state = useContext(Context);\n  return <div className=\"d-flex flex-grow-1 flex-column mt-1\">\n    <div className=\"d-flex justify-content-between\">\n      <h5>Store</h5>\n      <div>Space in store: {15 - state.inStore()} / 15</div>\n    </div>\n    <div className=\"d-flex flex-row\">\n      <Department deptKey='bakery' dept={state.departments['bakery']} />\n      <Department deptKey='dairy' dept={state.departments['dairy']} />\n      <Department deptKey='dryGoods' dept={state.departments['dryGoods']} />\n    </div>\n    <div className=\"d-flex flex-row\">\n      <Department deptKey='frozen' dept={state.departments['frozen']} />\n      <Department deptKey='produce' dept={state.departments['produce']} />\n    </div>\n  </div>;\n}\n\nexport default Store;","import React, { useState } from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\n\nimport { Context, State } from './State';\nimport { useLocalStorageState } from './Persistence';\nimport BlankCustomerCard from './BlankCustomerCard';\nimport CustomerCard from './CustomerCard';\nimport TopBar from './TopBar';\nimport StockRoom from './StockRoom';\nimport Store from './Store';\n\nexport default function App() {\n  const [i, setCount] = useState(0);\n  const [state, setState] = useLocalStorageState('AppState', new State());\n  state.setState = (newState: State) => {\n    setState(newState);\n    setCount(i + 1);\n  };\n  (window as any).app = state;\n  return <Router>\n    <Switch>\n      <Route path=\"/\">\n        <div className=\"d-flex flex-column\" style={{ width: \"100%\", maxWidth: \"1400px\", marginRight: 'auto', marginLeft: 'auto' }}>\n          <Context.Provider value={state}>\n            <TopBar />\n            <div className=\"d-flex flex-column flex-wrap\">\n              <div className=\"d-flex flex-row flex-grow-1\">\n                <Store />\n                <StockRoom />\n              </div>\n              <div className=\"d-flex\">\n                {state.currentCustomers.map((customer, i: number) => (\n                  customer.visible ?\n                    <CustomerCard key={i} customer={customer} index={i} /> :\n                    <BlankCustomerCard key={i} index={i} />\n                ))}\n              </div>\n            </div>\n          </Context.Provider>\n        </div>\n      </Route>\n    </Switch>\n  </Router >;\n}","import 'bootstrap/dist/css/bootstrap.css';\nimport 'jquery/dist/jquery.min.js'\nimport 'bootstrap/dist/js/bootstrap.min.js'\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}